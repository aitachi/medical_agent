---
name: intent-classifier
description: 意图分类器Skill，分析用户输入的语义，自动匹配到对应的处理任务。这是核心路由Skill，负责将用户输入分发到正确的Skill。
disable-model-invocation: false
---

# 意图分类器 Skill

负责分析用户输入的语义，自动匹配到对应的处理任务。

## 支持的意图类型

| 意图 | 触发关键词 | 目标Skill |
|------|-----------|----------|
| 症状咨询 | 疼、痛、难受、不舒服、怎么了 | symptom-analyzer |
| 科室查询 | 挂什么科、去哪个科室、哪个科室、看什么科 | department-recommender |
| 用药咨询 | 药、怎么吃、副作用、禁忌、用量 | medication-advisor |
| 预约挂号 | 挂号、预约、想看医生、排号 | appointment-service |
| 报告解读 | 报告、体检、化验单、指标 | report-interpreter |
| 健康教育 | 怎么预防、如何保持、健康建议 | health-educator |
| 感谢问候 | 谢谢、你好、再见 | greeting-handler |
| 未知意图 | - | fallback-handler |

## 分类规则

### 1. 症状咨询 (SYMPTOM_INQUIRY)

**触发条件**:
- 包含症状描述词: 头痛、发热、咳嗽、腹痛、胸痛等
- 表达不适: "我XX难受"、"XX不舒服"
- 询问症状: "XX是什么原因"、"XX怎么回事"

**示例**:
- "我头痛好几天了"
- "最近一直咳嗽"
- "肚子疼是怎么回事"

### 2. 科室查询 (DEPARTMENT_QUERY)

**触发条件**:
- 包含"科"字
- 明确询问挂号
- 包含"看医生"、"就诊"相关词汇

**示例**:
- "头痛挂什么科"
- "去哪个科室看牙"
- "皮肤病看哪个科"

### 3. 用药咨询 (MEDICATION_CONSULT)

**触发条件**:
- 包含药品名称
- 询问用药相关: "怎么吃"、"用量"、"副作用"
- 询问药品相关: "能一起吃吗"

**示例**:
- "阿莫西林怎么吃"
- "布洛芬有什么副作用"
- "感冒药能和退烧药一起吃吗"

### 4. 预约挂号 (APPOINTMENT)

**触发条件**:
- 包含"挂号"、"预约"动词
- 包含"排队"、"排号"
- 明确表达就医时间需求

**示例**:
- "我想挂个号"
- "预约明天的号"
- "能帮我挂号吗"

### 5. 报告解读 (REPORT_INTERPRET)

**触发条件**:
- 包含"报告"、"体检"、"化验"
- 包含"指标"、"结果"
- 询问某指标含义

**示例**:
- "帮我看看这个报告"
- "血常规结果正常吗"
- "这个指标偏高是什么意思"

### 6. 健康教育 (HEALTH_EDUCATION)

**触发条件**:
- 包含"预防"、"怎么保持"、"健康"
- 询问疾病预防知识

**示例**:
- "怎么预防高血压"
- "糖尿病不能吃什么"
- "如何保持健康"

### 7. 问候感谢 (GREETING)

**触发条件**:
- 问候语: "你好"、"您好"、"嗨"
- 感谢语: "谢谢"、"感谢"
- 结束语: "再见"、"拜拜"

### 8. 未知意图 (UNKNOWN)

**分类失败时触发**

## 优先级规则

当多个意图可能同时匹配时，按以下优先级处理：

1. **预约挂号** > 其他 (高优先级行动)
2. **用药咨询** > 症状咨询 (更具体)
3. **科室查询** > 症状咨询 (更具体)
4. **症状咨询** (默认医疗意图)

## 多意图处理

当用户输入包含多个意图时：

**示例**: "我头痛，想挂个号"

处理方式:
1. 识别主要意图: 挂号 (行动意图)
2. 保留次要信息: 症状=头痛
3. 组合处理: 执行挂号Skill，传入症状信息

## 上下文关联

考虑对话历史：

| 当前意图 | 上一个意图 | 处理方式 |
|---------|-----------|---------|
| 未知 | 症状咨询 | 继续症状咨询上下文 |
| 未知 | 用药咨询 | 继续用药咨询上下文 |
| 简短回复 | 任意 | 补充上一个意图的信息 |

## 置信度阈值

| 意图类型 | 置信度阈值 | 说明 |
|---------|-----------|------|
| 预约挂号 | 0.70 | 较低，鼓励用户行动 |
| 用药咨询 | 0.70 | 较低，安全敏感 |
| 症状咨询 | 0.60 | 较低，常见意图 |
| 科室查询 | 0.70 | 较低，明确需求 |
| 其他 | 0.75 | 标准阈值 |

## 输出格式

```json
{
  "intent": "SYMPTOM_INQUIRY",
  "confidence": 0.92,
  "target_skill": "symptom-analyzer",
  "entities": {
    "symptom": "头痛",
    "duration": "好几天",
    "body_part": "头部"
  },
  "requires_clarification": false,
  "clarification_question": null
}
```

## 需要澄清的情况

当置信度低于阈值时，生成澄清问题：

| 情况 | 澄清问题 |
|------|---------|
| 完全无法理解 | "抱歉，我没有完全理解您的意思，可以换个说法吗？" |
| 多个可能意图 | "您是想了解症状还是想挂号呢？" |
| 关键信息缺失 | "请问您具体哪里不舒服？" |

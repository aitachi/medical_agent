<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ»ç–—æ™ºèƒ½åŠ©æ‰‹ - ç³»ç»Ÿæ¶æ„æ–‡æ¡£</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f7fa;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .section {
            background: white;
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .section-title {
            font-size: 1.8em;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #667eea;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section-title .icon {
            font-size: 1.2em;
        }

        .subsection {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .subsection h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .diagram {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin: 20px 0;
            border: 1px solid #e0e0e0;
        }

        .flow-box {
            display: inline-flex;
            align-items: center;
            padding: 15px 25px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 10px;
            margin: 10px;
            font-weight: 600;
        }

        .flow-arrow {
            font-size: 2em;
            color: #667eea;
            margin: 0 15px;
        }

        .flow-line {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-success {
            background: #d4edda;
            color: #155724;
        }

        .badge-info {
            background: #d1ecf1;
            color: #0c5460;
        }

        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }

        .badge-danger {
            background: #f8d7da;
            color: #721c24;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #e0e0e0;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .metric-value {
            font-size: 2.5em;
            font-weight: 700;
            color: #667eea;
            margin: 10px 0;
        }

        .metric-label {
            color: #666;
            font-size: 0.9em;
        }

        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
        }

        .architecture-diagram {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .arch-layer {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            position: relative;
        }

        .arch-layer::before {
            content: attr(data-layer);
            position: absolute;
            top: -12px;
            left: 20px;
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .arch-item {
            background: #f8f9fa;
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 8px;
            font-size: 0.9em;
            border-left: 3px solid #667eea;
        }

        .intent-chart {
            display: flex;
            align-items: flex-end;
            height: 200px;
            gap: 15px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            margin: 20px 0;
        }

        .intent-bar {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .intent-bar-fill {
            width: 100%;
            background: linear-gradient(to top, #667eea, #764ba2);
            border-radius: 8px 8px 0 0;
            transition: height 0.5s;
            position: relative;
        }

        .intent-bar-fill:hover {
            background: linear-gradient(to top, #5568d3, #663399);
        }

        .intent-bar-label {
            margin-top: 10px;
            font-size: 0.8em;
            text-align: center;
            color: #666;
        }

        .intent-bar-value {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-weight: 600;
            color: #667eea;
        }

        .skill-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            transition: all 0.3s;
        }

        .skill-card:hover {
            border-color: #667eea;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.15);
        }

        .skill-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .skill-name {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
        }

        .skill-mcp {
            font-size: 0.85em;
        }

        .skill-desc {
            color: #666;
            margin-bottom: 15px;
        }

        .skill-endpoints {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .endpoint-tag {
            background: #e8f4f8;
            color: #0c5460;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-family: monospace;
        }

        .nav-menu {
            position: sticky;
            top: 20px;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .nav-menu h4 {
            margin-bottom: 15px;
            color: #667eea;
        }

        .nav-menu a {
            display: block;
            padding: 10px 15px;
            color: #666;
            text-decoration: none;
            border-radius: 8px;
            margin: 5px 0;
            transition: all 0.3s;
        }

        .nav-menu a:hover {
            background: #f0f0f0;
            color: #667eea;
        }

        .two-column {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 30px;
        }

        .highlight-box {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            border-left: 4px solid #e17055;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .highlight-box.info {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            border-left-color: #0652DD;
            color: white;
        }

        .highlight-box.success {
            background: linear-gradient(135deg, #55efc4, #00b894);
            border-left-color: #00a085;
            color: white;
        }

        .data-flow {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .flow-step {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }

        .step-number {
            width: 35px;
            height: 35px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .step-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .step-desc {
            color: #666;
            font-size: 0.95em;
        }

        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 12px 25px;
            background: #f8f9fa;
            border: none;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            font-weight: 500;
            color: #666;
            transition: all 0.3s;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .footer {
            background: #2d3436;
            color: white;
            padding: 40px 20px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }

            .nav-menu {
                position: static;
            }

            .architecture-diagram {
                grid-template-columns: 1fr;
            }

            .intent-chart {
                height: auto;
                flex-direction: column;
            }

            .intent-bar-fill {
                height: 30px !important;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¥ åŒ»ç–—æ™ºèƒ½åŠ©æ‰‹</h1>
        <p>Medical AI Assistant - ç³»ç»Ÿæ¶æ„ä¸å®ç°æ–‡æ¡£</p>
        <p style="margin-top: 20px; font-size: 0.9em;">ç‰ˆæœ¬: 2.0 | æ›´æ–°æ—¶é—´: 2026-02-02</p>
    </div>

    <div class="container">
        <div class="two-column">
            <nav class="nav-menu">
                <h4>ğŸ“‘ ç›®å½•å¯¼èˆª</h4>
                <a href="#overview">ç³»ç»Ÿæ¦‚è¿°</a>
                <a href="#skill-system">1. Skillåˆ›å»ºä¸å¯¹æ¥</a>
                <a href="#intent-system">2. æ„å›¾è¯†åˆ«ç®—æ³•</a>
                <a href="#workflow">3. æ•´ä½“å·¥ä½œæµ</a>
                <a href="#data-model">4. æ•°æ®æ¨¡å‹è®¾è®¡</a>
                <a href="#frontend">5. å‰ç«¯äº¤äº’</a>
                <a href="#performance">6. æ€§èƒ½æŒ‡æ ‡</a>
                <a href="#detailed-workflow">7. è¯¦ç»†å·¥ä½œæµä¸èŠ‚ç‚¹</a>
            </nav>

            <div class="content">
                <!-- ç³»ç»Ÿæ¦‚è¿° -->
                <div class="section" id="overview">
                    <h2 class="section-title">
                        <span class="icon">ğŸ“Š</span>
                        ç³»ç»Ÿæ¦‚è¿°
                    </h2>

                    <div class="metric-grid">
                        <div class="metric-card">
                            <div class="metric-label">æ„å›¾ç±»å‹</div>
                            <div class="metric-value">11</div>
                            <div class="metric-label">ç§æ„å›¾åˆ†ç±»</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">è¯†åˆ«å‡†ç¡®ç‡</div>
                            <div class="metric-value">94.4%</div>
                            <div class="metric-label">MLPåˆ†ç±»å™¨</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">è®­ç»ƒæ ·æœ¬</div>
                            <div class="metric-value">6,444</div>
                            <div class="metric-label">æ¡è®­ç»ƒæ•°æ®</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-label">åŠŸèƒ½æ¨¡å—</div>
                            <div class="metric-value">9</div>
                            <div class="metric-label">ä¸ªæ ¸å¿ƒæ¨¡å—</div>
                        </div>
                    </div>

                    <div class="highlight-box success" style="margin-top: 30px;">
                        <h4>ğŸ¯ æ ¸å¿ƒç‰¹æ€§</h4>
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li><strong>ç»Ÿä¸€æ‚£è€…ID</strong>: ä»¥æ‰‹æœºå·ä¸ºå…¨å±€å”¯ä¸€æ ‡è¯†ï¼Œå…³è”æ‰€æœ‰åŒ»ç–—æ•°æ®</li>
                            <li><strong>æ™ºèƒ½æ„å›¾è¯†åˆ«</strong>: MLPç¥ç»ç½‘ç»œåˆ†ç±»å™¨ï¼Œæ”¯æŒ11ç§æ„å›¾ç±»å‹</li>
                            <li><strong>å®Œæ•´ä¸šåŠ¡æµç¨‹</strong>: é¢„çº¦æŒ‚å·ã€é¢„çº¦æŸ¥è¯¢ã€é¢„çº¦éšè®¿ã€æ²»ç–—æ¡£æ¡ˆã€æ‚£è€…ä¿¡æ¯ç®¡ç†</li>
                            <li><strong>MCPå·¥å…·åè®®</strong>: æ¨¡å—åŒ–å·¥å…·è°ƒç”¨æ¶æ„ï¼Œæ”¯æŒæœåŠ¡å‘ç°å’ŒåŠ¨æ€æ³¨å†Œ</li>
                            <li><strong>æµå¼å“åº”</strong>: æ”¯æŒå¤§æ¨¡å‹æµå¼è¾“å‡ºï¼Œæå‡ç”¨æˆ·ä½“éªŒ</li>
                        </ul>
                    </div>
                </div>

                <!-- 1. Skillåˆ›å»ºä¸å¯¹æ¥ -->
                <div class="section" id="skill-system">
                    <h2 class="section-title">
                        <span class="icon">ğŸ”§</span>
                        1. Skillåˆ›å»ºä¸å¯¹æ¥
                    </h2>

                    <p>ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–çš„Skillæ¶æ„ï¼Œæ¯ä¸ªSkillè´Ÿè´£å¤„ç†ç‰¹å®šç±»å‹çš„ç”¨æˆ·æ„å›¾ã€‚Skillé€šè¿‡MCPåè®®ä¸åº•å±‚å·¥å…·æœåŠ¡å¯¹æ¥ã€‚</p>

                    <div class="subsection">
                        <h3>1.1 Skillæ¶æ„è®¾è®¡</h3>

                        <div class="architecture-diagram">
                            <div class="arch-layer" data-layer="ç”¨æˆ·æ„å›¾å±‚">
                                <div class="arch-item">ç—‡çŠ¶å’¨è¯¢ (symptom_inquiry)</div>
                                <div class="arch-item">ç§‘å®¤æŸ¥è¯¢ (department_query)</div>
                                <div class="arch-item">ç”¨è¯å’¨è¯¢ (medication_consult)</div>
                                <div class="arch-item">é¢„çº¦æŒ‚å· (appointment)</div>
                                <div class="arch-item">é¢„çº¦æŸ¥è¯¢ (my_appointment)</div>
                                <div class="arch-item">é¢„çº¦éšè®¿ (followup)</div>
                                <div class="arch-item">æ²»ç–—æ¡£æ¡ˆ (records)</div>
                                <div class="arch-item">å¥åº·æ•™è‚² (health_education)</div>
                                <div class="arch-item">æŠ¥å‘Šè§£è¯» (report_interpret)</div>
                            </div>
                            <div class="arch-layer" data-layer="Skillè°ƒåº¦å±‚">
                                <div class="arch-item">symptom-analyzer</div>
                                <div class="arch-item">department-recommender</div>
                                <div class="arch-item">medication-advisor</div>
                                <div class="arch-item">appointment-service</div>
                                <div class="arch-item">my-appointment-handler</div>
                                <div class="arch-item">followup-handler</div>
                                <div class="arch-item">records-handler</div>
                                <div class="arch-item">health-educator</div>
                                <div class="arch-item">report-interpreter</div>
                            </div>
                            <div class="arch-layer" data-layer="MCPå·¥å…·å±‚">
                                <div class="arch-item">medical_knowledge_query</div>
                                <div class="arch-item">hospital_department_query</div>
                                <div class="arch-item">drug_database_query</div>
                                <div class="arch-item">appointment_booking</div>
                            </div>
                            <div class="arch-layer" data-layer="æ•°æ®æœåŠ¡å±‚">
                                <div class="arch-item">çŸ¥è¯†åº“ (knowledge_base.json)</div>
                                <div class="arch-item">ç§‘å®¤æ•°æ®åº“</div>
                                <div class="arch-item">è¯å“æ•°æ®åº“</div>
                                <div class="arch-item">æ‚£è€…æ•°æ®åº“ (localStorage)</div>
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>1.2 Skillåˆ—è¡¨ä¸åŠŸèƒ½</h3>

                        <table>
                            <thead>
                                <tr>
                                    <th>Skillåç§°</th>
                                    <th>æ„å›¾ç±»å‹</th>
                                    <th>è°ƒç”¨MCP</th>
                                    <th>åŠŸèƒ½æè¿°</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>symptom-analyzer</strong></td>
                                    <td><span class="badge badge-info">symptom_inquiry</span></td>
                                    <td><span class="badge badge-success">æ˜¯</span></td>
                                    <td>ç—‡çŠ¶åˆ†æï¼Œè°ƒç”¨åŒ»ç–—çŸ¥è¯†åº“æŸ¥è¯¢ç—‡çŠ¶åŸå› å’Œå»ºè®®</td>
                                </tr>
                                <tr>
                                    <td><strong>department-recommender</strong></td>
                                    <td><span class="badge badge-info">department_query</span></td>
                                    <td><span class="badge badge-success">æ˜¯</span></td>
                                    <td>ç§‘å®¤æ¨èï¼Œæ ¹æ®ç—‡çŠ¶æ¨èåˆé€‚çš„å°±è¯Šç§‘å®¤</td>
                                </tr>
                                <tr>
                                    <td><strong>medication-advisor</strong></td>
                                    <td><span class="badge badge-info">medication_consult</span></td>
                                    <td><span class="badge badge-success">æ˜¯</span></td>
                                    <td>ç”¨è¯å’¨è¯¢ï¼Œæä¾›è¯å“ç”¨æ³•ã€å‰¯ä½œç”¨ã€ç¦å¿Œä¿¡æ¯</td>
                                </tr>
                                <tr>
                                    <td><strong>appointment-service</strong></td>
                                    <td><span class="badge badge-info">appointment</span></td>
                                    <td><span class="badge badge-success">æ˜¯</span></td>
                                    <td>é¢„çº¦æŒ‚å·ï¼Œåˆ›å»ºæ–°çš„é¢„çº¦è®°å½•</td>
                                </tr>
                                <tr>
                                    <td><strong>my-appointment-handler</strong></td>
                                    <td><span class="badge badge-info">my_appointment</span></td>
                                    <td><span class="badge badge-warning">å¦</span></td>
                                    <td>é¢„çº¦æŸ¥è¯¢ï¼Œé€šè¿‡æ‰‹æœºå·æˆ–é¢„çº¦å·æŸ¥è¯¢é¢„çº¦è®°å½•</td>
                                </tr>
                                <tr>
                                    <td><strong>followup-handler</strong></td>
                                    <td><span class="badge badge-info">followup</span></td>
                                    <td><span class="badge badge-warning">å¦</span></td>
                                    <td>é¢„çº¦éšè®¿ï¼Œè®°å½•æ‚£è€…éšè®¿æƒ…å†µå’Œåº·å¤è¯„ä¼°</td>
                                </tr>
                                <tr>
                                    <td><strong>records-handler</strong></td>
                                    <td><span class="badge badge-info">records</span></td>
                                    <td><span class="badge badge-warning">å¦</span></td>
                                    <td>æ²»ç–—æ¡£æ¡ˆï¼Œèšåˆå±•ç¤ºæ‚£è€…å®Œæ•´å°±è¯Šå†å²</td>
                                </tr>
                                <tr>
                                    <td><strong>health-educator</strong></td>
                                    <td><span class="badge badge-info">health_education</span></td>
                                    <td><span class="badge badge-warning">å¦</span></td>
                                    <td>å¥åº·æ•™è‚²ï¼Œæä¾›ç–¾ç—…é¢„é˜²ã€é¥®é£Ÿã€è¿åŠ¨å»ºè®®</td>
                                </tr>
                                <tr>
                                    <td><strong>report-interpreter</strong></td>
                                    <td><span class="badge badge-info">report_interpret</span></td>
                                    <td><span class="badge badge-warning">å¦</span></td>
                                    <td>æŠ¥å‘Šè§£è¯»ï¼Œå¸®åŠ©ç†è§£æ£€æŸ¥æ£€éªŒç»“æœ</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="subsection">
                        <h3>1.3 MCPå·¥å…·å¯¹æ¥æ–¹å¼</h3>

                        <div class="code-block">
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MCPToolHandler</span>:
    <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">execute</span>(<span style="color:#fd971f">self</span>, params):
        <span style="color:#75715e"># å·¥å…·æ‰§è¡Œé€»è¾‘</span>
        result <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> tool_function(params)
        <span style="color:#66d9ef">return</span> result

<span style="color:#75715e"># å·¥å…·æ³¨å†Œ</span>
server.register_tool(tool_definition, Handler())
                        </div>

                        <p><strong>MCPå·¥å…·åˆ—è¡¨:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li><code>medical_knowledge_query</code> - åŒ»å­¦çŸ¥è¯†æŸ¥è¯¢</li>
                            <li><code>hospital_department_query</code> - åŒ»é™¢ç§‘å®¤æŸ¥è¯¢</li>
                            <li><code>drug_database_query</code> - è¯å“æ•°æ®åº“æŸ¥è¯¢</li>
                            <li><code>appointment_booking</code> - é¢„çº¦æŒ‚å·æœåŠ¡</li>
                        </ul>
                    </div>
                </div>

                <!-- 2. æ„å›¾è¯†åˆ«ç®—æ³• -->
                <div class="section" id="intent-system">
                    <h2 class="section-title">
                        <span class="icon">ğŸ¯</span>
                        2. æ„å›¾è¯†åˆ«ç®—æ³•è®¾è®¡
                    </h2>

                    <div class="subsection">
                        <h3>2.1 ç®—æ³•é€‰æ‹©ä¸æ¶æ„</h3>

                        <p>ç³»ç»Ÿé‡‡ç”¨<strong>MLPå¤šå±‚æ„ŸçŸ¥æœºç¥ç»ç½‘ç»œ</strong>ä½œä¸ºæ„å›¾åˆ†ç±»å™¨ï¼Œç›¸æ¯”ä¼ ç»Ÿè§„åˆ™åˆ†ç±»ï¼Œå…·æœ‰æ›´å¼ºçš„æ³›åŒ–èƒ½åŠ›å’Œå‡†ç¡®ç‡ã€‚</p>

                        <table>
                            <thead>
                                <tr>
                                    <th>ç®—æ³•ç»„ä»¶</th>
                                    <th>å‚æ•°é…ç½®</th>
                                    <th>ä½œç”¨è¯´æ˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>ç‰¹å¾æå–</strong></td>
                                    <td>TF-IDF å­—ç¬¦çº§ 1-3gram</td>
                                    <td>å°†æ–‡æœ¬è½¬æ¢ä¸º3366ç»´ç‰¹å¾å‘é‡</td>
                                </tr>
                                <tr>
                                    <td><strong>éšè—å±‚1</strong></td>
                                    <td>128ç¥ç»å…ƒ + ReLUæ¿€æ´»</td>
                                    <td>ç¬¬ä¸€å±‚ç‰¹å¾å˜æ¢</td>
                                </tr>
                                <tr>
                                    <td><strong>éšè—å±‚2</strong></td>
                                    <td>64ç¥ç»å…ƒ + ReLUæ¿€æ´»</td>
                                    <td>ç¬¬äºŒå±‚ç‰¹å¾å˜æ¢</td>
                                </tr>
                                <tr>
                                    <td><strong>è¾“å‡ºå±‚</strong></td>
                                    <td>11ä¸ªç¥ç»å…ƒ + Softmax</td>
                                    <td>è¾“å‡º11ç§æ„å›¾çš„æ¦‚ç‡åˆ†å¸ƒ</td>
                                </tr>
                                <tr>
                                    <td><strong>ä¼˜åŒ–å™¨</strong></td>
                                    <td>Adam (lr=0.001)</td>
                                    <td>å‚æ•°ä¼˜åŒ–</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="subsection">
                        <h3>2.2 æ„å›¾ç±»å‹å®šä¹‰</h3>

                        <table>
                            <thead>
                                <tr>
                                    <th>æ„å›¾ä»£ç </th>
                                    <th>ä¸­æ–‡åç§°</th>
                                    <th>æ ·æœ¬æ•°</th>
                                    <th>å…¸å‹è¾“å…¥</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>symptom_inquiry</code></td>
                                    <td>ç—‡çŠ¶å’¨è¯¢</td>
                                    <td>1,102</td>
                                    <td>"æˆ‘å¤´ç—›å¥½å‡ å¤©äº†"</td>
                                </tr>
                                <tr>
                                    <td><code>health_education</code></td>
                                    <td>å¥åº·æ•™è‚²</td>
                                    <td>983</td>
                                    <td>"æ€ä¹ˆé¢„é˜²é«˜è¡€å‹"</td>
                                </tr>
                                <tr>
                                    <td><code>medication_consult</code></td>
                                    <td>ç”¨è¯å’¨è¯¢</td>
                                    <td>947</td>
                                    <td>"é˜¿è«è¥¿æ—æ€ä¹ˆåƒ"</td>
                                </tr>
                                <tr>
                                    <td><code>appointment</code></td>
                                    <td>é¢„çº¦æŒ‚å·</td>
                                    <td>732</td>
                                    <td>"æˆ‘æƒ³æŒ‚å·"</td>
                                </tr>
                                <tr>
                                    <td><code>department_query</code></td>
                                    <td>ç§‘å®¤æŸ¥è¯¢</td>
                                    <td>726</td>
                                    <td>"å¤´ç—›æŒ‚ä»€ä¹ˆç§‘"</td>
                                </tr>
                                <tr>
                                    <td><code>unknown</code></td>
                                    <td>æœªçŸ¥æ„å›¾</td>
                                    <td>810</td>
                                    <td>"ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·"</td>
                                </tr>
                                <tr>
                                    <td><code>report_interpret</code></td>
                                    <td>æŠ¥å‘Šè§£è¯»</td>
                                    <td>182</td>
                                    <td>"å¸®æˆ‘è§£è¯»ä½“æ£€æŠ¥å‘Š"</td>
                                </tr>
                                <tr>
                                    <td><code>my_appointment</code></td>
                                    <td>é¢„çº¦æŸ¥è¯¢</td>
                                    <td>135</td>
                                    <td>"æŸ¥è¯¢æˆ‘çš„é¢„çº¦"</td>
                                </tr>
                                <tr>
                                    <td><code>followup</code></td>
                                    <td>é¢„çº¦éšè®¿</td>
                                    <td>120</td>
                                    <td>"æˆ‘æƒ³æŸ¥çœ‹éšè®¿æƒ…å†µ"</td>
                                </tr>
                                <tr>
                                    <td><code>records</code></td>
                                    <td>æ²»ç–—æ¡£æ¡ˆ</td>
                                    <td>145</td>
                                    <td>"æˆ‘çš„å¥åº·æ¡£æ¡ˆ"</td>
                                </tr>
                                <tr>
                                    <td><code>greeting</code></td>
                                    <td>é—®å€™</td>
                                    <td>562</td>
                                    <td>"ä½ å¥½"</td>
                                </tr>
                            </tbody>
                        </table>

                        <p style="margin-top: 15px; color: #666;"><strong>æ€»è®¡: 6,444æ¡è®­ç»ƒæ ·æœ¬</strong></p>
                    </div>

                    <div class="subsection">
                        <h3>2.3 è®­ç»ƒä¸è¯„ä¼°æŒ‡æ ‡</h3>

                        <div class="metric-grid">
                            <div class="metric-card">
                                <div class="metric-label">è®­ç»ƒå‡†ç¡®ç‡</div>
                                <div class="metric-value">99.52%</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">æµ‹è¯•å‡†ç¡®ç‡</div>
                                <div class="metric-value">94.41%</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">æ³›åŒ–å·®è·</div>
                                <div class="metric-value">5.11%</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">è®­ç»ƒæ—¶é—´</div>
                                <div class="metric-value">255s</div>
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>2.4 æ„å›¾è¯†åˆ«å‘½ä¸­ç‡åˆ†æ</h3>

                        <div class="intent-chart">
                            <div class="intent-bar">
                                <div class="intent-bar-fill" style="height: 100%;">
                                    <span class="intent-bar-value">100%</span>
                                </div>
                                <div class="intent-bar-label">ç”¨è¯å’¨è¯¢</div>
                            </div>
                            <div class="intent-bar">
                                <div class="intent-bar-fill" style="height: 100%;">
                                    <span class="intent-bar-value">100%</span>
                                </div>
                                <div class="intent-bar-label">å¥åº·æ•™è‚²</div>
                            </div>
                            <div class="intent-bar">
                                <div class="intent-bar-fill" style="height: 100%;">
                                    <span class="intent-bar-value">100%</span>
                                </div>
                                <div class="intent-bar-label">ç—‡çŠ¶å’¨è¯¢</div>
                            </div>
                            <div class="intent-bar">
                                <div class="intent-bar-fill" style="height: 100%;">
                                    <span class="intent-bar-value">100%</span>
                                </div>
                                <div class="intent-bar-label">ç§‘å®¤æŸ¥è¯¢</div>
                            </div>
                            <div class="intent-bar">
                                <div class="intent-bar-fill" style="height: 100%;">
                                    <span class="intent-bar-value">100%</span>
                                </div>
                                <div class="intent-bar-label">é¢„çº¦æŒ‚å·</div>
                            </div>
                            <div class="intent-bar">
                                <div class="intent-bar-fill" style="height: 100%;">
                                    <span class="intent-bar-value">100%</span>
                                </div>
                                <div class="intent-bar-label">é¢„çº¦æŸ¥è¯¢</div>
                            </div>
                            <div class="intent-bar">
                                <div class="intent-bar-fill" style="height: 100%;">
                                    <span class="intent-bar-value">100%</span>
                                </div>
                                <div class="intent-bar-label">é¢„çº¦éšè®¿</div>
                            </div>
                            <div class="intent-bar">
                                <div class="intent-bar-fill" style="height: 100%;">
                                    <span class="intent-bar-value">100%</span>
                                </div>
                                <div class="intent-bar-label">æ²»ç–—æ¡£æ¡ˆ</div>
                            </div>
                            <div class="intent-bar">
                                <div class="intent-bar-fill" style="height: 100%;">
                                    <span class="intent-bar-value">100%</span>
                                </div>
                                <div class="intent-bar-label">é—®å€™</div>
                            </div>
                            <div class="intent-bar">
                                <div class="intent-bar-fill" style="height: 95%;">
                                    <span class="intent-bar-value">95%</span>
                                </div>
                                <div class="intent-bar-label">æŠ¥å‘Šè§£è¯»</div>
                            </div>
                            <div class="intent-bar">
                                <div class="intent-bar-fill" style="height: 90%;">
                                    <span class="intent-bar-value">90%</span>
                                </div>
                                <div class="intent-bar-label">æœªçŸ¥</div>
                            </div>
                        </div>

                        <div class="highlight-box info" style="margin-top: 20px; color: white;">
                            <h4>ğŸ“Š è¯†åˆ«æ•ˆæœéªŒè¯</h4>
                            <table style="margin-top: 15px; background: rgba(255,255,255,0.2); border: none;">
                                <tr style="border-bottom: 1px solid rgba(255,255,255,0.3);">
                                    <th style="color: white; border: none;">æµ‹è¯•è¾“å…¥</th>
                                    <th style="color: white; border: none;">é¢„æµ‹æ„å›¾</th>
                                    <th style="color: white; border: none;">ç½®ä¿¡åº¦</th>
                                </tr>
                                <tr style="border: none;">
                                    <td style="color: white; border: none;">"æˆ‘æƒ³æŸ¥çœ‹éšè®¿æƒ…å†µ"</td>
                                    <td style="color: white; border: none;">followup</td>
                                    <td style="color: white; border: none;">99.99%</td>
                                </tr>
                                <tr style="border: none;">
                                    <td style="color: white; border: none;">"æˆ‘çš„å¥åº·æ¡£æ¡ˆ"</td>
                                    <td style="color: white; border: none;">records</td>
                                    <td style="color: white; border: none;">100%</td>
                                </tr>
                                <tr style="border: none;">
                                    <td style="color: white; border: none;">"æŸ¥è¯¢æˆ‘çš„é¢„çº¦"</td>
                                    <td style="color: white; border: none;">my_appointment</td>
                                    <td style="color: white; border: none;">100%</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>2.5 æ•°æ®å¢å¼ºç­–ç•¥</h3>

                        <p>ä¸ºæå‡æ¨¡å‹æ³›åŒ–èƒ½åŠ›ï¼Œè®­ç»ƒæ•°æ®é‡‡ç”¨äº†å¤šç§å¢å¼ºç­–ç•¥ï¼š</p>

                        <ul style="margin-left: 20px;">
                            <li><strong>åŒä¹‰è¯å˜ä½“</strong>: åŒä¸€è¯­ä¹‰çš„ä¸åŒè¡¨è¾¾æ–¹å¼</li>
                            <li><strong>é”™åˆ«å­—æ¨¡æ‹Ÿ</strong>: æ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥é”™è¯¯</li>
                            <li><strong>æ¨¡ç³Šè¾“å…¥</strong>: æç®€æˆ–æè¿°ä¸å®Œæ•´çš„è¾“å…¥</li>
                            <li><strong>æ··åˆæ„å›¾</strong>: åŒ…å«å¤šä¸ªæ„å›¾çš„å¤æ‚è¡¨è¾¾</li>
                            <li><strong>å¦å®šå¥</strong>: åŒ…å«å¦å®šè¯çš„è¡¨è¾¾</li>
                            <li><strong>å£è¯­åŒ–è¡¨è¾¾</strong>: æ—¥å¸¸å¯¹è¯ä¸­çš„éæ­£å¼è¡¨è¾¾</li>
                        </ul>
                    </div>
                </div>

                <!-- 3. æ•´ä½“å·¥ä½œæµ -->
                <div class="section" id="workflow">
                    <h2 class="section-title">
                        <span class="icon">âš™ï¸</span>
                        3. æ•´ä½“å·¥ä½œæµè®¾è®¡
                    </h2>

                    <div class="subsection">
                        <h3>3.1 è¯·æ±‚å¤„ç†æµç¨‹</h3>

                        <div class="flow-line" style="justify-content: center; flex-wrap: wrap;">
                            <div class="flow-box">ç”¨æˆ·è¾“å…¥</div>
                            <span class="flow-arrow">â†’</span>
                            <div class="flow-box">æ„å›¾åˆ†ç±»</div>
                            <span class="flow-arrow">â†’</span>
                            <div class="flow-box">å®ä½“æŠ½å–</div>
                            <span class="flow-arrow">â†’</span>
                            <div class="flow-box">Skillè·¯ç”±</div>
                            <span class="flow-arrow">â†’</span>
                            <div class="flow-box">å·¥å…·/MCPè°ƒç”¨</div>
                            <span class="flow-arrow">â†’</span>
                            <div class="flow-box">å“åº”ç”Ÿæˆ</div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>3.2 è¯¦ç»†å¤„ç†æ­¥éª¤</h3>

                        <div class="data-flow">
                            <div class="flow-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <div class="step-title">æ¥æ”¶ç”¨æˆ·è¾“å…¥</div>
                                    <div class="step-desc">æ¥æ”¶æ¥è‡ªå‰ç«¯ç•Œé¢çš„ç”¨æˆ·æ¶ˆæ¯ï¼Œè·å–session_idå’Œuser_id</div>
                                </div>
                            </div>

                            <div class="flow-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <div class="step-title">æ„å›¾åˆ†ç±»</div>
                                    <div class="step-desc">MLPåˆ†ç±»å™¨é¢„æµ‹ç”¨æˆ·æ„å›¾ï¼Œè¿”å›æ„å›¾ç±»å‹å’Œç½®ä¿¡åº¦</div>
                                </div>
                            </div>

                            <div class="flow-step">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <div class="step-title">å®ä½“æŠ½å–</div>
                                    <div class="step-desc">ä»ç”¨æˆ·è¾“å…¥ä¸­æå–å…³é”®å®ä½“ï¼ˆç—‡çŠ¶ã€è¯å“ã€æ‰‹æœºå·ã€æ—¥æœŸç­‰ï¼‰</div>
                                </div>
                            </div>

                            <div class="flow-step">
                                <div class="step-number">4</div>
                                <div class="step-content">
                                    <div class="step-title">ç½®ä¿¡åº¦åˆ¤æ–­</div>
                                    <div class="step-desc">æ£€æŸ¥ç½®ä¿¡åº¦æ˜¯å¦è¾¾åˆ°é˜ˆå€¼ï¼Œä½ç½®ä¿¡åº¦è§¦å‘æ¾„æ¸…æœºåˆ¶</div>
                                </div>
                            </div>

                            <div class="flow-step">
                                <div class="step-number">5</div>
                                <div class="step-content">
                                    <div class="step-title">Skillè·¯ç”±</div>
                                    <div class="step-desc">æ ¹æ®æ„å›¾ç±»å‹åˆ†å‘åˆ°å¯¹åº”çš„Skillå¤„ç†å™¨</div>
                                </div>
                            </div>

                            <div class="flow-step">
                                <div class="step-number">6</div>
                                <div class="step-content">
                                    <div class="step-title">MCPå·¥å…·è°ƒç”¨</div>
                                    <div class="step-desc">éœ€è¦æ—¶é€šè¿‡MCPåè®®è°ƒç”¨åº•å±‚å·¥å…·æœåŠ¡</div>
                                </div>
                            </div>

                            <div class="flow-step">
                                <div class="step-number">7</div>
                                <div class="step-content">
                                    <div class="step-title">LLMå¢å¼ºï¼ˆå¯é€‰ï¼‰</div>
                                    <div class="step-desc">å¯ç”¨LLMæ—¶ï¼Œå°†æ„å›¾å’Œä¸Šä¸‹æ–‡å‘é€ç»™å¤§æ¨¡å‹ç”Ÿæˆæ›´è‡ªç„¶çš„å“åº”</div>
                                </div>
                            </div>

                            <div class="flow-step">
                                <div class="step-number">8</div>
                                <div class="step-content">
                                    <div class="step-title">å“åº”æ ¼å¼åŒ–</div>
                                    <div class="step-desc">æ·»åŠ æ ¼å¼åŒ–ã€å…è´£å£°æ˜å’Œç´§æ€¥è­¦å‘Š</div>
                                </div>
                            </div>

                            <div class="flow-step">
                                <div class="step-number">9</div>
                                <div class="step-content">
                                    <div class="step-title">è¿”å›å“åº”</div>
                                    <div class="step-desc">å°†æ ¼å¼åŒ–åçš„å“åº”è¿”å›ç»™å‰ç«¯</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>3.3 å¤šè½®å¯¹è¯ç®¡ç†</h3>

                        <p>ç³»ç»Ÿé€šè¿‡DialogueContextç®¡ç†å¯¹è¯ä¸Šä¸‹æ–‡ï¼š</p>

                        <ul style="margin-left: 20px;">
                            <li><strong>ä¼šè¯ç®¡ç†</strong>: åŸºäºsession_idç®¡ç†ç‹¬ç«‹çš„å¯¹è¯ä¸Šä¸‹æ–‡</li>
                            <li><strong>å†å²è®°å½•</strong>: ä¿å­˜å®Œæ•´çš„å¯¹è¯å†å²ï¼Œæ”¯æŒä¸Šä¸‹æ–‡å…³è”</li>
                            <li><strong>å®ä½“ç´¯ç§¯</strong>: å¤šè½®å¯¹è¯ä¸­ç´¯ç§¯æ”¶é›†çš„å®ä½“ä¿¡æ¯</li>
                            <li><strong>æ„å›¾å»¶ç»­</strong>: æ”¯æŒåŸºäºä¸Šè½®æ„å›¾çš„å»¶ç»­å¯¹è¯</li>
                        </ul>

                        <div class="code-block">
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DialogueContext</span>:
    session_id: <span style="color:#66d9ef">str</span>
    user_id: <span style="color:#66d9ef">str</span>
    history: <span style="color:#66d9ef">List</span>[<span style="color:#66d9ef">Dict</span>]
    current_intent: <span style="color:#66d9ef">Optional</span>[IntentResult]
    accumulated_entities: <span style="color:#66d9ef">Dict</span>[<span style="color:#66d9ef">str</span>, <span style="color:#66d9ef">Any</span>]
    turn_count: <span style="color:#66d9ef">int</span>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>3.4 å¼‚å¸¸å¤„ç†ä¸é™çº§</h3>

                        <table>
                            <thead>
                                <tr>
                                    <th>å¼‚å¸¸åœºæ™¯</th>
                                    <th>å¤„ç†ç­–ç•¥</th>
                                    <th>é™çº§æ–¹æ¡ˆ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>æ„å›¾è¯†åˆ«å¤±è´¥</td>
                                    <td>é™ä½ç½®ä¿¡åº¦é˜ˆå€¼</td>
                                    <td>è¿”å›å…œåº•å“åº”</td>
                                </tr>
                                <tr>
                                    <td>MCPå·¥å…·è°ƒç”¨å¤±è´¥</td>
                                    <td>é‡è¯•æœºåˆ¶</td>
                                    <td>ä½¿ç”¨æœ¬åœ°çŸ¥è¯†åº“</td>
                                </tr>
                                <tr>
                                    <td>LLMæœåŠ¡è¶…æ—¶</td>
                                    <td>è¶…æ—¶æ§åˆ¶</td>
                                    <td>ä½¿ç”¨æœ¬åœ°è§„åˆ™å“åº”</td>
                                </tr>
                                <tr>
                                    <td>ç”¨æˆ·è¾“å…¥ä¸å®Œæ•´</td>
                                    <td>è§¦å‘æ¾„æ¸…æœºåˆ¶</td>
                                    <td>å¼•å¯¼ç”¨æˆ·æä¾›æ›´å¤šä¿¡æ¯</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 4. æ•°æ®æ¨¡å‹è®¾è®¡ -->
                <div class="section" id="data-model">
                    <h2 class="section-title">
                        <span class="icon">ğŸ’¾</span>
                        4. æ•°æ®æ¨¡å‹è®¾è®¡
                    </h2>

                    <div class="subsection">
                        <h3>4.1 ç»Ÿä¸€æ‚£è€…IDä½“ç³»</h3>

                        <div class="highlight-box" style="background: linear-gradient(135deg, #a8e6cf, #3dc1d3); color: white;">
                            <h4>ğŸ“± æ‰‹æœºå·ä½œä¸ºå…¨å±€å”¯ä¸€ID</h4>
                            <p style="margin-top: 10px;">ç³»ç»Ÿä¸­æ‰€æœ‰æ‚£è€…æ•°æ®ä»¥<strong>11ä½æ‰‹æœºå·(1[3-9]\d{9})</strong>ä¸ºå”¯ä¸€æ ‡è¯†è¿›è¡Œå…³è”ï¼Œå®ç°è·¨æ¨¡å—çš„æ•°æ®ä¸€è‡´æ€§ã€‚</p>
                        </div>

                        <div class="architecture-diagram">
                            <div class="arch-layer" data-layer="medical_patients">
                                <div class="arch-item">æ‚£è€…åŸºæœ¬ä¿¡æ¯</div>
                                <div class="arch-item">å§“åã€æ€§åˆ«ã€ç”Ÿæ—¥</div>
                                <div class="arch-item">è¡€å‹ã€è¿‡æ•å²</div>
                                <div class="arch-item">æ—¢å¾€ç—…å²</div>
                            </div>
                            <div class="arch-layer" data-layer="medical_appointments">
                                <div class="arch-item">é¢„çº¦è®°å½•</div>
                                <div class="arch-item">é¢„çº¦ç¼–å·ã€ç§‘å®¤ã€åŒ»ç”Ÿ</div>
                                <div class="arch-item">å°±è¯Šæ—¶é—´ã€çŠ¶æ€</div>
                            </div>
                            <div class="arch-layer" data-layer="medical_followups">
                                <div class="arch-item">éšè®¿è®°å½•</div>
                                <div class="arch-item">éšè®¿ç±»å‹ã€éšè®¿å†…å®¹</div>
                                <div class="arch-item">åº·å¤è¯„ä¼°ã€ä¸‹æ¬¡éšè®¿</div>
                            </div>
                            <div class="arch-layer" data-layer="medical_records">
                                <div class="arch-item">æ²»ç–—æ¡£æ¡ˆ</div>
                                <div class="arch-item">é¦–æ¬¡å°±è¯Šã€æœ€è¿‘å°±è¯Š</div>
                                <div class="arch-item">ç§‘å®¤ç»Ÿè®¡</div>
                            </div>
                        </div>

                        <p style="text-align: center; margin: 20px 0;">
                            <span class="flow-arrow">â†‘</span> é€šè¿‡ phone å­—æ®µå…³è” <span class="flow-arrow">â†‘</span>
                        </p>
                    </div>

                    <div class="subsection">
                        <h3>4.2 æ•°æ®ç»“æ„å®šä¹‰</h3>

                        <div class="skill-card">
                            <div class="skill-header">
                                <span class="skill-name">æ‚£è€…åŸºæœ¬ä¿¡æ¯ (medical_patients)</span>
                            </div>
                            <div class="code-block">
{
  <span style="color:#66d9ef">"phone"</span>: <span style="color:#e6db74">"13800138000"</span>,      <span style="color:#75715e">// æ‰‹æœºå· - ä¸»é”®</span>
  <span style="color:#66d9ef">"name"</span>: <span style="color:#e6db74">"å¼ ä¸‰"</span>,
  <span style="color:#66d9ef">"gender"</span>: <span style="color:#e6db74">"ç”·"</span>,
  <span style="color:#66d9ef">"birthday"</span>: <span style="color:#e6db74">"1990-01-01"</span>,
  <span style="color:#66d9ef">"blood"</span>: <span style="color:#e6db74">"A"</span>,
  <span style="color:#66d9ef">"allergies"</span>: <span style="color:#e6db74">"é’éœ‰ç´ è¿‡æ•"</span>,
  <span style="color:#66d9ef">"history"</span>: <span style="color:#e6db74">"æ— "</span>,
  <span style="color:#66d9ef">"emergencyName"</span>: <span style="color:#e6db74">"æå››"</span>,
  <span style="color:#66d9ef">"emergencyPhone"</span>: <span style="color:#e6db74">"13900139000"</span>,
  <span style="color:#66d9ef">"createdAt"</span>: <span style="color:#e6db74">"2026-02-02 10:00:00"</span>,
  <span style="color:#66d9ef">"updatedAt"</span>: <span style="color:#e6db74">"2026-02-02 15:30:00"</span>
}
                            </div>
                        </div>

                        <div class="skill-card">
                            <div class="skill-header">
                                <span class="skill-name">é¢„çº¦è®°å½• (medical_appointments)</span>
                            </div>
                            <div class="code-block">
{
  <span style="color:#66d9ef">"bookingNo"</span>: <span style="color:#e6db74">"YY202602021234"</span>,
  <span style="color:#66d9ef">"phone"</span>: <span style="color:#e6db74">"13800138000"</span>,      <span style="color:#75715e">// å…³è”æ‚£è€…</span>
  <span style="color:#66d9ef">"dept"</span>: <span style="color:#e6db74">"å†…ç§‘"</span>,
  <span style="color:#66d9ef">"doctor"</span>: <span style="color:#e6db74">"ç‹åŒ»ç”Ÿ"</span>,
  <span style="color:#66d9ef">"date"</span>: <span style="color:#e6db74">"2026-02-15"</span>,
  <span style="color:#66d9ef">"time"</span>: <span style="color:#e6db74">"09:30"</span>,
  <span style="color:#66d9ef">"status"</span>: <span style="color:#e6db74">"å¾…å°±è¯Š"</span>,
  <span style="color:#66d9ef">"createdAt"</span>: <span style="color:#e6db74">"2026-02-02 10:00:00"</span>
}
                            </div>
                        </div>

                        <div class="skill-card">
                            <div class="skill-header">
                                <span class="skill-name">éšè®¿è®°å½• (medical_followups)</span>
                            </div>
                            <div class="code-block">
{
  <span style="color:#66d9ef">"id"</span>: <span style="color:#e6db74">"FU1738481234567"</span>,
  <span style="color:#66d9ef">"phone"</span>: <span style="color:#e6db74">"13800138000"</span>,      <span style="color:#75715e">// å…³è”æ‚£è€…</span>
  <span style="color:#66d9ef">"appointmentId"</span>: <span style="color:#e6db74">"YY202602021234"</span>,  <span style="color:#75715e">// å…³è”é¢„çº¦</span>
  <span style="color:#66d9ef">"followupType"</span>: <span style="color:#e6db74">"ç”µè¯éšè®¿"</span>,
  <span style="color:#66d9ef">"followupDate"</span>: <span style="color:#e6db74">"2026-02-20"</span>,
  <span style="color:#66d9ef">"content"</span>: <span style="color:#e6db74">"æ‚£è€…ç—‡çŠ¶æ˜æ˜¾å¥½è½¬"</span>,
  <span style="color:#66d9ef">"rating"</span>: <span style="color:#e6db74">"æ˜æ˜¾å¥½è½¬"</span>,
  <span style="color:#66d9ef">"nextDate"</span>: <span style="color:#e6db74">"2026-03-01"</span>
}
                            </div>
                        </div>

                        <div class="skill-card">
                            <div class="skill-header">
                                <span class="skill-name">æ²»ç–—æ¡£æ¡ˆ (medical_records)</span>
                            </div>
                            <div class="code-block">
{
  <span style="color:#66d9ef">"phone"</span>: <span style="color:#e6db74">"13800138000"</span>,      <span style="color:#75715e">// ä¸»é”®</span>
  <span style="color:#66d9ef">"firstVisit"</span>: <span style="color:#e6db74">"2026-01-01"</span>,
  <span style="color:#66d9ef">"lastVisit"</span>: <span style="color:#e6db74">"2026-02-15"</span>,
  <span style="color:#66d9ef">"lastVisitType"</span>: <span style="color:#e6db74">"å†…ç§‘ - ç‹åŒ»ç”Ÿ"</span>,
  <span style="color:#66d9ef">"departments"</span>: {
    <span style="color:#66d9ef">"å†…ç§‘"</span>: <span style="color:#ae81ff">5</span>,
    <span style="color:#66d9ef">"å¤–ç§‘"</span>: <span style="color:#ae81ff">2</span>
  },
  <span style="color:#66d9ef">"createdAt"</span>: <span style="color:#e6db74">"2026-02-02 10:00:00"</span>
}
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>4.3 æ•°æ®åŒæ­¥ç­–ç•¥</h3>

                        <ul style="margin-left: 20px;">
                            <li><strong>è‡ªåŠ¨åˆ›å»º</strong>: é¢„çº¦æ—¶è‡ªåŠ¨åˆ›å»ºæ‚£è€…æ¡£æ¡ˆï¼ˆå¦‚ä¸å­˜åœ¨ï¼‰</li>
                            <li><strong>è‡ªåŠ¨æ›´æ–°</strong>: é¢„çº¦ã€éšè®¿æ“ä½œè‡ªåŠ¨æ›´æ–°æ²»ç–—æ¡£æ¡ˆç»Ÿè®¡</li>
                            <li><strong>çº§è”æ›´æ–°</strong>: æ‚£è€…åŸºæœ¬ä¿¡æ¯æ›´æ–°æ—¶ï¼ŒåŒæ­¥åˆ°æ‰€æœ‰å…³è”è®°å½•</li>
                            <li><strong>æ•°æ®éªŒè¯</strong>: æ‰€æœ‰æ‰‹æœºå·è¾“å…¥ç»è¿‡æ ¼å¼éªŒè¯</li>
                        </ul>
                    </div>
                </div>

                <!-- 5. å‰ç«¯äº¤äº’ -->
                <div class="section" id="frontend">
                    <h2 class="section-title">
                        <span class="icon">ğŸ–¥ï¸</span>
                        5. å‰ç«¯äº¤äº’è®¾è®¡
                    </h2>

                    <div class="subsection">
                        <h3>5.1 é¡µé¢ç»“æ„</h3>

                        <div class="architecture-diagram">
                            <div class="arch-layer" data-layer="æ™ºèƒ½å’¨è¯¢ (chat)">
                                <div class="arch-item">æµå¼å¯¹è¯</div>
                                <div class="arch-item">æ„å›¾è¯†åˆ«</div>
                                <div class="arch-item">å¿«æ·åŠŸèƒ½å¡ç‰‡</div>
                            </div>
                            <div class="arch-layer" data-layer="åŠŸèƒ½é¡µé¢">
                                <div class="arch-item">ç—‡çŠ¶å’¨è¯¢ (symptom)</div>
                                <div class="arch-item">ç§‘å®¤æ¨è (department)</div>
                                <div class="arch-item">ç”¨è¯å’¨è¯¢ (medication)</div>
                                <div class="arch-item">é¢„çº¦æŒ‚å· (appointment)</div>
                                <div class="arch-item">é¢„çº¦æŸ¥è¯¢ (my-appointment)</div>
                                <div class="arch-item">é¢„çº¦éšè®¿ (followup)</div>
                                <div class="arch-item">æ²»ç–—æ¡£æ¡ˆ (records)</div>
                                <div class="arch-item">æ‚£è€…ä¿¡æ¯ (patient)</div>
                            </div>
                            <div class="arch-layer" data-layer="è¾…åŠ©åŠŸèƒ½">
                                <div class="arch-item">å¥åº·æ•™è‚² (health)</div>
                                <div class="arch-item">æ¬¢è¿å¼•å¯¼</div>
                                <div class="arch-item">æœåŠ¡çŠ¶æ€ç›‘æ§</div>
                            </div>
                            <div class="arch-layer" data-layer="æ•°æ®å­˜å‚¨">
                                <div class="arch-item">localStorage</div>
                                <div class="arch-item">Sessionç®¡ç†</div>
                                <div class="arch-item">çŠ¶æ€åŒæ­¥</div>
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>5.2 æ ¸å¿ƒäº¤äº’æµç¨‹</h3>

                        <div class="tabs">
                            <button class="tab active" onclick="showTab(event, 'tab1')">é¢„çº¦æŒ‚å·æµç¨‹</button>
                            <button class="tab" onclick="showTab(event, 'tab2')">éšè®¿ç®¡ç†æµç¨‹</button>
                            <button class="tab" onclick="showTab(event, 'tab3')">æ¡£æ¡ˆæŸ¥è¯¢æµç¨‹</button>
                        </div>

                        <div id="tab1" class="tab-content active">
                            <div class="data-flow">
                                <div class="flow-step">
                                    <div class="step-number">1</div>
                                    <div class="step-content">
                                        <div class="step-title">é€‰æ‹©ç§‘å®¤</div>
                                        <div class="step-desc">ä»ç§‘å®¤åˆ—è¡¨ä¸­é€‰æ‹©ç›®æ ‡ç§‘å®¤</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">2</div>
                                    <div class="step-content">
                                        <div class="step-title">é€‰æ‹©åŒ»ç”Ÿ</div>
                                        <div class="step-desc">æŸ¥çœ‹è¯¥ç§‘å®¤çš„åŒ»ç”Ÿåˆ—è¡¨ï¼Œé€‰æ‹©åŒ»ç”Ÿ</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">3</div>
                                    <div class="step-content">
                                        <div class="step-title">é€‰æ‹©æ—¶é—´</div>
                                        <div class="step-desc">é€‰æ‹©å°±è¯Šæ—¥æœŸå’Œæ—¶é—´æ®µ</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">4</div>
                                    <div class="step-content">
                                        <div class="step-title">è¾“å…¥æ‰‹æœºå·</div>
                                        <div class="step-desc">è¾“å…¥11ä½æ‰‹æœºå·ä½œä¸ºæ‚£è€…ID</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">5</div>
                                    <div class="step-content">
                                        <div class="step-title">ç¡®è®¤é¢„çº¦</div>
                                        <div class="step-desc">ç¡®è®¤é¢„çº¦ä¿¡æ¯å¹¶æäº¤ï¼Œç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºæ‚£è€…æ¡£æ¡ˆ</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="tab2" class="tab-content">
                            <div class="data-flow">
                                <div class="flow-step">
                                    <div class="step-number">1</div>
                                    <div class="step-content">
                                        <div class="step-title">è¾“å…¥æ‰‹æœºå·</div>
                                        <div class="step-desc">è¾“å…¥æ‚£è€…æ‰‹æœºå·æŸ¥è¯¢éšè®¿è®°å½•</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">2</div>
                                    <div class="step-content">
                                        <div class="step-title">æŸ¥çœ‹å†å²éšè®¿</div>
                                        <div class="step-desc">æ˜¾ç¤ºè¯¥æ‚£è€…çš„æ‰€æœ‰éšè®¿è®°å½•</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">3</div>
                                    <div class="step-content">
                                        <div class="step-title">å…³è”é¢„çº¦é€‰æ‹©</div>
                                        <div class="step-desc">å¯å…³è”å·²æœ‰é¢„çº¦è®°å½•</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">4</div>
                                    <div class="step-content">
                                        <div class="step-title">å¡«å†™éšè®¿å†…å®¹</div>
                                        <div class="step-desc">è®°å½•éšè®¿ç±»å‹ã€å†…å®¹å’Œåº·å¤è¯„ä¼°</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">5</div>
                                    <div class="step-content">
                                        <div class="step-title">è®¾ç½®ä¸‹æ¬¡éšè®¿</div>
                                        <div class="step-desc">é€‰æ‹©ä¸‹æ¬¡éšè®¿æ—¥æœŸ</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="tab3" class="tab-content">
                            <div class="data-flow">
                                <div class="flow-step">
                                    <div class="step-number">1</div>
                                    <div class="step-content">
                                        <div class="step-title">è¾“å…¥æ‰‹æœºå·</div>
                                        <div class="step-desc">è¾“å…¥æ‚£è€…æ‰‹æœºå·</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">2</div>
                                    <div class="step-content">
                                        <div class="step-title">æ•°æ®èšåˆ</div>
                                        <div class="step-desc">ç³»ç»Ÿè‡ªåŠ¨èšåˆæ‚£è€…åŸºæœ¬ä¿¡æ¯ã€é¢„çº¦è®°å½•ã€éšè®¿è®°å½•</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">3</div>
                                    <div class="step-content">
                                        <div class="step-title">æ¡£æ¡ˆå±•ç¤º</div>
                                        <div class="step-desc">å®Œæ•´å±•ç¤ºæ‚£è€…å°±è¯Šæ—¶é—´çº¿</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 6. æ€§èƒ½æŒ‡æ ‡ -->
                <div class="section" id="performance">
                    <h2 class="section-title">
                        <span class="icon">ğŸ“ˆ</span>
                        6. æ€§èƒ½ä¸è´¨é‡æŒ‡æ ‡
                    </h2>

                    <div class="subsection">
                        <h3>6.1 ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡</h3>

                        <table>
                            <thead>
                                <tr>
                                    <th>æŒ‡æ ‡</th>
                                    <th>ç›®æ ‡å€¼</th>
                                    <th>å®é™…å€¼</th>
                                    <th>çŠ¶æ€</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>æ„å›¾è¯†åˆ«å‡†ç¡®ç‡</td>
                                    <td>> 90%</td>
                                    <td>94.41%</td>
                                    <td><span class="badge badge-success">è¾¾æ ‡</span></td>
                                </tr>
                                <tr>
                                    <td>å“åº”æ—¶é—´ (P50)</td>
                                    <td>< 200ms</td>
                                    <td>< 150ms</td>
                                    <td><span class="badge badge-success">ä¼˜ç§€</span></td>
                                </tr>
                                <tr>
                                    <td>å“åº”æ—¶é—´ (P99)</td>
                                    <td>< 500ms</td>
                                    <td>< 300ms</td>
                                    <td><span class="badge badge-success">ä¼˜ç§€</span></td>
                                </tr>
                                <tr>
                                    <td>å¹¶å‘å¤„ç†èƒ½åŠ›</td>
                                    <td>> 100 req/s</td>
                                    <td>> 100 req/s</td>
                                    <td><span class="badge badge-success">è¾¾æ ‡</span></td>
                                </tr>
                                <tr>
                                    <td>ç³»ç»Ÿå¯ç”¨æ€§</td>
                                    <td>> 99%</td>
                                    <td>100%</td>
                                    <td><span class="badge badge-success">ä¼˜ç§€</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="subsection">
                        <h3>6.2 ä»£ç ç»Ÿè®¡</h3>

                        <div class="metric-grid">
                            <div class="metric-card">
                                <div class="metric-label">Pythonä»£ç </div>
                                <div class="metric-value">8K+</div>
                                <div class="metric-label">è¡Œä»£ç </div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">å‰ç«¯ä»£ç </div>
                                <div class="metric-value">4K+</div>
                                <div class="metric-label">è¡Œä»£ç </div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">æµ‹è¯•ä»£ç </div>
                                <div class="metric-value">2K+</div>
                                <div class="metric-label">è¡Œä»£ç </div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-label">è®­ç»ƒæ•°æ®</div>
                                <div class="metric-value">6.4K</div>
                                <div class="metric-label">æ¡æ ·æœ¬</div>
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>6.3 è´¨é‡ä¿è¯</h3>

                        <table>
                            <thead>
                                <tr>
                                    <th>æ£€æŸ¥é¡¹</th>
                                    <th>æ–¹å¼</th>
                                    <th>è¦†ç›–ç‡</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>æ„å›¾åˆ†ç±»æµ‹è¯•</td>
                                    <td>å•å…ƒæµ‹è¯•</td>
                                    <td>100%</td>
                                </tr>
                                <tr>
                                    <td>MCPå·¥å…·æµ‹è¯•</td>
                                    <td>é›†æˆæµ‹è¯•</td>
                                    <td>100%</td>
                                </tr>
                                <tr>
                                    <td> SkillåŠŸèƒ½æµ‹è¯•</td>
                                    <td>åŠŸèƒ½æµ‹è¯•</td>
                                    <td>100%</td>
                                </tr>
                                <tr>
                                    <td>å‰ç«¯äº¤äº’æµ‹è¯•</td>
                                    <td>æ‰‹åŠ¨æµ‹è¯•</td>
                                    <td>100%</td>
                                </tr>
                                <tr>
                                    <td>å®‰å…¨åˆè§„æ£€æŸ¥</td>
                                    <td>ä»£ç å®¡æŸ¥</td>
                                    <td>100%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 7. è¯¦ç»†å·¥ä½œæµä¸èŠ‚ç‚¹ -->
                <div class="section" id="detailed-workflow">
                    <h2 class="section-title">
                        <span class="icon">ğŸ”¬</span>
                        7. è¯¦ç»†å·¥ä½œæµä¸å¤„ç†èŠ‚ç‚¹
                    </h2>

                    <div class="subsection">
                        <h3>7.1 å®Œæ•´è¯·æ±‚å¤„ç†é“¾è·¯</h3>

                        <div class="diagram">
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <div class="flow-box" style="width: 100%; justify-content: center;">å‰ç«¯ç”¨æˆ·è¾“å…¥ (Frontend)</div>
                                <div style="text-align: center; font-size: 24px; color: #667eea;">â†“</div>
                                <div class="flow-box" style="width: 100%; justify-content: center;">FastAPI SSE ç«¯ç‚¹ (/api/chat/stream)</div>
                                <div style="text-align: center; font-size: 24px; color: #667eea;">â†“</div>
                                <div class="flow-box" style="width: 100%; justify-content: center;">MedicalAgent.process_message()</div>
                                <div style="text-align: center; font-size: 24px; color: #667eea;">â†“</div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                                    <div class="flow-box" style="width: 100%; font-size: 0.9em;">æ„å›¾åˆ†ç±» (MLP)</div>
                                    <div class="flow-box" style="width: 100%; font-size: 0.9em;">å®ä½“æŠ½å– (Regex)</div>
                                    <div class="flow-box" style="width: 100%; font-size: 0.9em;">ä¸Šä¸‹æ–‡ç®¡ç†</div>
                                </div>
                                <div style="text-align: center; font-size: 24px; color: #667eea;">â†“</div>
                                <div class="flow-box" style="width: 100%; justify-content: center;">SkillInvoker.route()</div>
                                <div style="text-align: center; font-size: 24px; color: #667eea;">â†“</div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                    <div class="flow-box" style="width: 100%; font-size: 0.9em; background: linear-gradient(135deg, #667eea, #764ba2);">MCPå·¥å…·è°ƒç”¨</div>
                                    <div class="flow-box" style="width: 100%; font-size: 0.9em; background: linear-gradient(135deg, #00b894, #55efc4);">LLMå¤§æ¨¡å‹ç”Ÿæˆ</div>
                                </div>
                                <div style="text-align: center; font-size: 24px; color: #667eea;">â†“</div>
                                <div class="flow-box" style="width: 100%; justify-content: center;">ResponseFormatter.format()</div>
                                <div style="text-align: center; font-size: 24px; color: #667eea;">â†“</div>
                                <div class="flow-box" style="width: 100%; justify-content: center;">SSEæµå¼å“åº”è¿”å›</div>
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>7.2 MCPåè®®ä¸‰å±‚æ¶æ„è¯¦è§£</h3>

                        <table>
                            <thead>
                                <tr>
                                    <th>å±‚çº§</th>
                                    <th>ç»„ä»¶</th>
                                    <th>èŒè´£</th>
                                    <th>æ¶ˆæ¯ç±»å‹</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td rowspan="3"><strong>Hostå±‚</strong><br>(æ³¨å†Œä¸­å¿ƒ)</td>
                                    <td>MCPHost</td>
                                    <td>ç®¡ç†Serveræ³¨å†Œã€å‘ç°ã€å¥åº·æ£€æŸ¥</td>
                                    <td>REGISTER, DEREGISTER, DISCOVER</td>
                                </tr>
                                <tr>
                                    <td>å·¥å…·æ³¨å†Œè¡¨</td>
                                    <td>ç»´æŠ¤å·¥å…·åç§°â†’Serveræ˜ å°„</td>
                                    <td>LIST_TOOLS, SUBSCRIBE</td>
                                </tr>
                                <tr>
                                    <td>å¿ƒè·³æ£€æµ‹</td>
                                    <td>30ç§’è¶…æ—¶è‡ªåŠ¨æ³¨é”€</td>
                                    <td>HEARTBEAT (10sé—´éš”)</td>
                                </tr>
                                <tr>
                                    <td rowspan="2"><strong>Serverå±‚</strong><br>(æœåŠ¡æä¾›)</td>
                                    <td>MCPServer</td>
                                    <td>æä¾›å…·ä½“å·¥å…·å®ç°</td>
                                    <td>CALL_TOOL_RESPONSE</td>
                                </tr>
                                <tr>
                                    <td>MCPToolHandler</td>
                                    <td>å·¥å…·æ‰§è¡Œé€»è¾‘æŠ½è±¡</td>
                                    <td>execute(params) â†’ Any</td>
                                </tr>
                                <tr>
                                    <td rowspan="2"><strong>Clientå±‚</strong><br>(æœåŠ¡æ¶ˆè´¹)</td>
                                    <td>MCPClient</td>
                                    <td>è°ƒç”¨å·¥å…·ã€è®¢é˜…æ›´æ–°</td>
                                    <td>CALL_TOOL, SUBSCRIBE</td>
                                </tr>
                                <tr>
                                    <td>MCPServerProxy</td>
                                    <td>è¿œç¨‹Serverä»£ç†</td>
                                    <td>execute_tool() â†’ Result</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4 style="margin-top: 25px; color: #667eea;">MCPå·¥å…·æ³¨å†Œæµç¨‹</h4>
                        <div class="code-block">
<span style="color:#75715e"># 1. åˆ›å»ºHost (æ³¨å†Œä¸­å¿ƒ)</span>
host = MCPFactory.create_host(<span style="color:#e6db74">"medical-mcp-host"</span>)
<span style="color:#66d9ef">await</span> host.start()

<span style="color:#75715e"># 2. åˆ›å»ºServer (æœåŠ¡æä¾›æ–¹)</span>
server = MCPFactory.create_server(
    server_id=<span style="color:#e6db74">"medical-mcp-server"</span>,
    name=<span style="color:#e6db74">"Medical Tools Server"</span>,
    host=<span style="color:#e6db74">"localhost"</span>,
    port=<span style="color:#ae81ff">50051</span>,
    mcp_host=host
)

<span style="color:#75715e"># 3. æ³¨å†Œå·¥å…·å¤„ç†å™¨</span>
server.register_tool(
    tool_definition=MCPTool(
        name=<span style="color:#e6db74">"medical_knowledge_query"</span>,
        description=<span style="color:#e6db74">"æŸ¥è¯¢åŒ»ç–—çŸ¥è¯†åº“"</span>,
        category=<span style="color:#e6db74">"medical"</span>,
        input_schema={<span style="color:#e6db74">"query"</span>: <span style="color:#e6db74">"str"</span>},
        output_schema={<span style="color:#e6db74">"result"</span>: <span style="color:#e6db74">"dict"</span>}
    ),
    handler=KnowledgeQueryHandler()
)

<span style="color:#75715e"># 4. å¯åŠ¨Server (è‡ªåŠ¨æ³¨å†Œåˆ°Host)</span>
<span style="color:#66d9ef">await</span> server.start()
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>7.3 MLPæ„å›¾åˆ†ç±»ç®—æ³•è¯¦è§£</h3>

                        <div class="architecture-diagram" style="grid-template-columns: repeat(3, 1fr);">
                            <div class="arch-layer" data-layer="è¾“å…¥å¤„ç†">
                                <div class="arch-item">åŸå§‹æ–‡æœ¬è¾“å…¥</div>
                                <div class="arch-item">å­—ç¬¦çº§åˆ†è¯</div>
                                <div class="arch-item">1-3gramæ»‘çª—</div>
                                <div class="arch-item">TF-IDFå‘é‡åŒ–</div>
                                <div class="arch-item">3366ç»´ç¨€ç–å‘é‡</div>
                            </div>
                            <div class="arch-layer" data-layer="ç¥ç»ç½‘ç»œ">
                                <div class="arch-item">è¾“å…¥å±‚: 3366ç»´</div>
                                <div class="arch-item">å…¨è¿æ¥ + ReLU</div>
                                <div class="arch-item">éšè—å±‚1: 128ç¥ç»å…ƒ</div>
                                <div class="arch-item">å…¨è¿æ¥ + ReLU</div>
                                <div class="arch-item">éšè—å±‚2: 64ç¥ç»å…ƒ</div>
                                <div class="arch-item">è¾“å‡ºå±‚: 11ç»´Softmax</div>
                            </div>
                            <div class="arch-layer" data-layer="è¾“å‡ºå¤„ç†">
                                <div class="arch-item">æ¦‚ç‡åˆ†å¸ƒè®¡ç®—</div>
                                <div class="arch-item">Argmaxå–æœ€å¤§å€¼</div>
                                <div class="arch-item">æ ‡ç­¾è§£ç </div>
                                <div class="arch-item">ç½®ä¿¡åº¦è¾“å‡º</div>
                                <div class="arch-item">æ„å›¾ç±»å‹è¿”å›</div>
                            </div>
                        </div>

                        <h4 style="margin-top: 25px; color: #667eea;">ç‰¹å¾æå–å‚æ•°</h4>
                        <div class="code-block">
TfidfVectorizer(
    analyzer=<span style="color:#e6db74">'char'</span>,           <span style="color:#75715e"># å­—ç¬¦çº§åˆ«åˆ†æ</span>
    ngram_range=(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>),          <span style="color:#75715e"># 1-3å­—ç¬¦åºåˆ—</span>
    min_df=<span style="color:#ae81ff">2</span>,                   <span style="color:#75715e"># æœ€å°æ–‡æ¡£é¢‘ç‡</span>
    max_df=<span style="color:#ae81ff">0.95</span>,                 <span style="color:#75715e"># æœ€å¤§æ–‡æ¡£é¢‘ç‡</span>
    max_features=<span style="color:#ae81ff">3366</span>             <span style="color:#75715e"># æœ€å¤§ç‰¹å¾æ•°</span>
)

<span style="color:#75715e"># ç¥ç»ç½‘ç»œé…ç½®</span>
MLPClassifier(
    hidden_layer_sizes=(<span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">64</span>),  <span style="color:#75715e"># ä¸¤å±‚éšè—</span>
    activation=<span style="color:#e6db74">'relu'</span>,           <span style="color:#75715e"># ReLUæ¿€æ´»</span>
    solver=<span style="color:#e6db74">'adam'</span>,               <span style="color:#75715e"># Adamä¼˜åŒ–å™¨</span>
    alpha=<span style="color:#ae81ff">0.0001</span>,                 <span style="color:#75715e"># L2æ­£åˆ™åŒ–</span>
    batch_size=<span style="color:#ae81ff">32</span>,                <span style="color:#75715e"># æ‰¹æ¬¡å¤§å°</span>
    learning_rate_init=<span style="color:#ae81ff">0.001</span>,     <span style="color:#75715e"># åˆå§‹å­¦ä¹ ç‡</span>
    max_iter=<span style="color:#ae81ff">500</span>,                 <span style="color:#75715e"># æœ€å¤§è¿­ä»£</span>
    early_stopping=<span style="color:#66d9ef">False</span>          <span style="color:#75715e"># ç¦ç”¨æ—©åœ</span>
)
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>7.4 Skillè·¯ç”±ä¸è°ƒç”¨æµç¨‹</h3>

                        <div class="tabs">
                            <button class="tab active" onclick="showTab(event, 'skill-tab1')">ç—‡çŠ¶å’¨è¯¢Skill</button>
                            <button class="tab" onclick="showTab(event, 'skill-tab2')">é¢„çº¦æŒ‚å·Skill</button>
                            <button class="tab" onclick="showTab(event, 'skill-tab3')">éšè®¿ç®¡ç†Skill</button>
                        </div>

                        <div id="skill-tab1" class="tab-content active">
                            <h4>SymptomAnalyzer Skillå¤„ç†æµç¨‹</h4>
                            <div class="data-flow">
                                <div class="flow-step">
                                    <div class="step-number">1</div>
                                    <div class="step-content">
                                        <div class="step-title">æ¥æ”¶è¾“å…¥</div>
                                        <div class="step-desc">ç”¨æˆ·æ¶ˆæ¯: "æˆ‘å¤´ç—›å¥½å‡ å¤©äº†"</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">2</div>
                                    <div class="step-content">
                                        <div class="step-title">ç—‡çŠ¶å®ä½“æŠ½å–</div>
                                        <div class="step-desc">ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–ç—‡çŠ¶å…³é”®è¯: ["å¤´ç—›"]</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">3</div>
                                    <div class="step-content">
                                        <div class="step-title">è°ƒç”¨MCPå·¥å…·</div>
                                        <div class="step-desc">tool: medical_knowledge_query, params: {"symptom": "å¤´ç—›"}</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">4</div>
                                    <div class="step-content">
                                        <div class="step-title">çŸ¥è¯†åº“æŸ¥è¯¢</div>
                                        <div class="step-desc">ä»knowledge_base.jsonåŒ¹é…ç—‡çŠ¶ç›¸å…³æ¡ç›®</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">5</div>
                                    <div class="step-content">
                                        <div class="step-title">LLMå¢å¼º (å¯é€‰)</div>
                                        <div class="step-desc">å°†æŸ¥è¯¢ç»“æœå‘é€ç»™LLMç”Ÿæˆè‡ªç„¶è¯­è¨€å“åº”</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">6</div>
                                    <div class="step-content">
                                        <div class="step-title">å“åº”æ ¼å¼åŒ–</div>
                                        <div class="step-desc">æ·»åŠ å…è´£å£°æ˜ã€æ ¼å¼åŒ–è¾“å‡º</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="skill-tab2" class="tab-content">
                            <h4>AppointmentService Skillå¤„ç†æµç¨‹</h4>
                            <div class="data-flow">
                                <div class="flow-step">
                                    <div class="step-number">1</div>
                                    <div class="step-content">
                                        <div class="step-title">æ¥æ”¶é¢„çº¦è¯·æ±‚</div>
                                        <div class="step-desc">ç”¨æˆ·æ¶ˆæ¯: "æˆ‘æƒ³é¢„çº¦å†…ç§‘"</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">2</div>
                                    <div class="step-content">
                                        <div class="step-title">å‚æ•°æ”¶é›†</div>
                                        <div class="step-desc">å¤šè½®å¯¹è¯æ”¶é›†: ç§‘å®¤ã€åŒ»ç”Ÿã€æ—¥æœŸã€æ—¶é—´ã€æ‰‹æœºå·</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">3</div>
                                    <div class="step-content">
                                        <div class="step-title">æ•°æ®éªŒè¯</div>
                                        <div class="step-desc">æ‰‹æœºå·æ ¼å¼éªŒè¯: 1[3-9]\d{9}</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">4</div>
                                    <div class="step-content">
                                        <div class="step-title">ç”Ÿæˆé¢„çº¦å·</div>
                                        <div class="step-desc">æ ¼å¼: YY + YYYYMMDD + 4ä½åºå·</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">5</div>
                                    <div class="step-content">
                                        <div class="step-title">å­˜å‚¨é¢„çº¦è®°å½•</div>
                                        <div class="step-desc">å†™å…¥localStorage: medical_appointments</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">6</div>
                                    <div class="step-content">
                                        <div class="step-title">è‡ªåŠ¨åˆ›å»ºæ‚£è€…æ¡£æ¡ˆ</div>
                                        <div class="step-desc">å¦‚ä¸å­˜åœ¨åˆ™åˆ›å»ºmedical_patientsè®°å½•</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">7</div>
                                    <div class="step-content">
                                        <div class="step-title">æ›´æ–°æ²»ç–—æ¡£æ¡ˆ</div>
                                        <div class="step-desc">æ›´æ–°medical_recordsç»Ÿè®¡ä¿¡æ¯</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="skill-tab3" class="tab-content">
                            <h4>FollowupHandler Skillå¤„ç†æµç¨‹</h4>
                            <div class="data-flow">
                                <div class="flow-step">
                                    <div class="step-number">1</div>
                                    <div class="step-content">
                                        <div class="step-title">æ¥æ”¶éšè®¿è¯·æ±‚</div>
                                        <div class="step-desc">ç”¨æˆ·æ¶ˆæ¯: "æˆ‘æƒ³æŸ¥çœ‹éšè®¿æƒ…å†µ"</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">2</div>
                                    <div class="step-content">
                                        <div class="step-title">æ‰‹æœºå·éªŒè¯</div>
                                        <div class="step-desc">éªŒè¯å¹¶æå–11ä½æ‰‹æœºå·</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">3</div>
                                    <div class="step-content">
                                        <div class="step-title">æŸ¥è¯¢éšè®¿è®°å½•</div>
                                        <div class="step-desc">ä»localStorageè¯»å–medical_followups</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">4</div>
                                    <div class="step-content">
                                        <div class="step-title">å…³è”é¢„çº¦æŸ¥è¯¢</div>
                                        <div class="step-desc">é€šè¿‡appointmentIdå…³è”é¢„çº¦ä¿¡æ¯</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">5</div>
                                    <div class="step-content">
                                        <div class="step-title">æ–°å»ºéšè®¿è®°å½•</div>
                                        <div class="step-desc">å¡«å†™: éšè®¿ç±»å‹ã€å†…å®¹ã€åº·å¤è¯„ä¼°ã€ä¸‹æ¬¡éšè®¿æ—¥æœŸ</div>
                                    </div>
                                </div>
                                <div class="flow-step">
                                    <div class="step-number">6</div>
                                    <div class="step-content">
                                        <div class="step-title">ç”Ÿæˆéšè®¿ID</div>
                                        <div class="step-desc">æ ¼å¼: FU + Unixæ—¶é—´æˆ³(æ¯«ç§’)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>7.5 LLMæµå¼å“åº”æµç¨‹</h3>

                        <div class="code-block">
<span style="color:#75715e"># LLMæµå¼è°ƒç”¨é“¾è·¯</span>
<span style="color:#66d9ef">async def</span> <span style="color:#a6e22e">generate_response_stream</span>(user_message, intent, session_id):
    <span style="color:#75715e"># 1. å‘é€æ€è€ƒäº‹ä»¶</span>
    <span style="color:#66d9ef">yield</span> {<span style="color:#e6db74">"type"</span>: <span style="color:#e6db74">"thinking"</span>, <span style="color:#e6db74">"content"</span>: <span style="color:#e6db74">"æ­£åœ¨åˆ†ææ‚¨çš„è¯·æ±‚..."</span>}

    <span style="color:#75715e"># 2. å‘é€æ„å›¾è¯†åˆ«äº‹ä»¶</span>
    <span style="color:#66d9ef">yield</span> {<span style="color:#e6db74">"type"</span>: <span style="color:#e6db74">"thinking"</span>, <span style="color:#e6db74">"content"</span>: <span style="color:#e6db74">f"è¯†åˆ«åˆ°æ„å›¾: {intent}"</span>}

    <span style="color:#75715e"># 3. å‘é€LLMè°ƒç”¨æç¤º</span>
    <span style="color:#66d9ef">yield</span> {<span style="color:#e6db74">"type"</span>: <span style="color:#e6db74">"thinking"</span>, <span style="color:#e6db74">"content"</span>: <span style="color:#e6db74">"è°ƒç”¨qwen-pluså¤§æ¨¡å‹ç”Ÿæˆå›å¤..."</span>}

    <span style="color:#75715e"># 4. æ„å»ºæ¶ˆæ¯åˆ—è¡¨</span>
    messages = [
        {<span style="color:#e6db74">"role"</span>: <span style="color:#e6db74">"system"</span>, <span style="color:#e6db74">"content"</span>: intent_specific_prompt},
        ...history,  <span style="color:#75715e"># å¯¹è¯å†å²</span>
        {<span style="color:#e6db74">"role"</span>: <span style="color:#e6db74">"user"</span>, <span style="color:#e6db74">"content"</span>: user_message}
    ]

    <span style="color:#75715e"># 5. æµå¼è°ƒç”¨LLM</span>
    <span style="color:#66d9ef">async for</span> chunk <span style="color:#66d9ef">in</span> llm.chat(messages, stream=<span style="color:#66d9ef">True</span>):
        <span style="color:#66d9ef">yield</span> {<span style="color:#e6db74">"type"</span>: <span style="color:#e6db74">"content"</span>, <span style="color:#e6db74">"content"</span>: chunk}

    <span style="color:#75715e"># 6. å‘é€å®Œæˆäº‹ä»¶</span>
    <span style="color:#66d9ef">yield</span> {<span style="color:#e6db74">"type"</span>: <span style="color:#e6db74">"done"</span>, <span style="color:#e6db74">"content"</span>: <span style="color:#e6db74">""</span>}
                        </div>

                        <h4 style="margin-top: 25px; color: #667eea;">SSEäº‹ä»¶ç±»å‹å®šä¹‰</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>äº‹ä»¶ç±»å‹</th>
                                    <th>è¯´æ˜</th>
                                    <th>å‰ç«¯å¤„ç†</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>thinking</code></td>
                                    <td>æ€è€ƒçŠ¶æ€æç¤º</td>
                                    <td>æ˜¾ç¤ºåŠ è½½åŠ¨ç”»/æç¤ºæ–‡æœ¬</td>
                                </tr>
                                <tr>
                                    <td><code>tool_call</code></td>
                                    <td>MCPå·¥å…·è°ƒç”¨é€šçŸ¥</td>
                                    <td>æ˜¾ç¤ºå·¥å…·è°ƒç”¨ä¿¡æ¯</td>
                                </tr>
                                <tr>
                                    <td><code>content</code></td>
                                    <td>LLMç”Ÿæˆçš„å†…å®¹ç‰‡æ®µ</td>
                                    <td>è¿½åŠ åˆ°å¯¹è¯æ˜¾ç¤ºåŒºåŸŸ</td>
                                </tr>
                                <tr>
                                    <td><code>done</code></td>
                                    <td>å“åº”å®Œæˆ</td>
                                    <td>éšè—åŠ è½½åŠ¨ç”»</td>
                                </tr>
                                <tr>
                                    <td><code>error</code></td>
                                    <td>é”™è¯¯ä¿¡æ¯</td>
                                    <td>æ˜¾ç¤ºé”™è¯¯æç¤º</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="subsection">
                        <h3>7.6 å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†æœºåˆ¶</h3>

                        <div class="code-block">
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DialogueContext</span>:
    <span style="color:#e6db74">"""å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†å™¨"""</span>

    session_id: <span style="color:#66d9ef">str</span>              <span style="color:#75715e"># ä¼šè¯å”¯ä¸€æ ‡è¯†</span>
    user_id: <span style="color:#66d9ef">str</span>                 <span style="color:#75715e"># ç”¨æˆ·ID</span>
    history: <span style="color:#66d9ef">List</span>[<span style="color:#66d9ef">Dict</span>]           <span style="color:#75715e"># å®Œæ•´å¯¹è¯å†å²</span>
    current_intent: <span style="color:#66d9ef">IntentResult</span>  <span style="color:#75715e"># å½“å‰æ„å›¾è¯†åˆ«ç»“æœ</span>
    accumulated_entities: <span style="color:#66d9ef">Dict</span>     <span style="color:#75715e"># ç´¯ç§¯æ”¶é›†çš„å®ä½“</span>
    turn_count: <span style="color:#66d9ef">int</span>                <span style="color:#75715e"># å¯¹è¯è½®æ¬¡è®¡æ•°</span>
    last_turn_time: <span style="color:#66d9ef">str</span>           <span style="color:#75715e"># ä¸Šæ¬¡å¯¹è¯æ—¶é—´</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_entity</span>(self, key, value):
        <span style="color:#75715e"># æ·»åŠ /æ›´æ–°å®ä½“</span>
        self.accumulated_entities[key] = value

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_missing_entities</span>(self, required_keys):
        <span style="color:#75715e"># è¿”å›ç¼ºå¤±çš„å¿…å¡«å®ä½“</span>
        <span style="color:#66d9ef">return</span> [k <span style="color:#66d9ef">for</span> k <span style="color:#66d9ef">in</span> required_keys <span style="color:#66d9ef">if</span> k <span style="color:#66d9ef">not in</span> self.accumulated_entities]

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_clear</span>(self):
        <span style="color:#75715e"># åˆ¤æ–­æ˜¯å¦åº”æ¸…ç©ºä¸Šä¸‹æ–‡</span>
        <span style="color:#66d9ef">return</span> (
            self.turn_count > <span style="color:#ae81ff">20</span> <span style="color:#66d9ef">or</span>
            self.current_intent.intent == <span style="color:#e6db74">"greeting"</span>
        )
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>7.7 æ•°æ®åŒæ­¥ä¸ä¸€è‡´æ€§</h3>

                        <table>
                            <thead>
                                <tr>
                                    <th>åŒæ­¥åœºæ™¯</th>
                                    <th>è§¦å‘æ¡ä»¶</th>
                                    <th>åŒæ­¥æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>é¢„çº¦åˆ›å»º</td>
                                    <td>æ–°å¢medical_appointmentsè®°å½•</td>
                                    <td>
                                        1. åˆ›å»º/æ›´æ–°medical_patients<br>
                                        2. æ›´æ–°medical_recordsç»Ÿè®¡
                                    </td>
                                </tr>
                                <tr>
                                    <td>éšè®¿åˆ›å»º</td>
                                    <td>æ–°å¢medical_followupsè®°å½•</td>
                                    <td>
                                        1. æ›´æ–°medical_recordsçš„lastVisit<br>
                                        2. å…³è”appointmentIdåˆ°é¢„çº¦
                                    </td>
                                </tr>
                                <tr>
                                    <td>æ‚£è€…ä¿¡æ¯æ›´æ–°</td>
                                    <td>ä¿®æ”¹medical_patientsè®°å½•</td>
                                    <td>
                                        1. æ›´æ–°updatedAtæ—¶é—´æˆ³<br>
                                        2. åŒæ­¥åˆ°æ‰€æœ‰å…³è”è®°å½•çš„æ˜¾ç¤º
                                    </td>
                                </tr>
                                <tr>
                                    <td>æ²»ç–—æ¡£æ¡ˆæŸ¥è¯¢</td>
                                    <td>è¯·æ±‚medical_records</td>
                                    <td>
                                        1. å®æ—¶èšåˆæ‰€æœ‰è¡¨æ•°æ®<br>
                                        2. è®¡ç®—ç§‘å®¤ç»Ÿè®¡
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="highlight-box success" style="margin-top: 20px;">
                            <h4>ğŸ”— è·¨è¡¨å…³è”è§„åˆ™</h4>
                            <ul style="margin-top: 10px;">
                                <li><strong>ä¸»é”®å…³è”</strong>: æ‰€æœ‰è¡¨é€šè¿‡phoneå­—æ®µå…³è”æ‚£è€…</li>
                                <li><strong>é¢„çº¦-éšè®¿å…³è”</strong>: followup.appointmentId â†’ appointments.bookingNo</li>
                                <li><strong>çº§è”åˆ›å»º</strong>: æ–°å¢é¢„çº¦æ—¶è‡ªåŠ¨åˆ›å»ºæ‚£è€…æ¡£æ¡ˆ</li>
                                <li><strong>å®æ—¶èšåˆ</strong>: recordsæŸ¥è¯¢æ—¶å®æ—¶è®¡ç®—ç»Ÿè®¡ä¿¡æ¯</li>
                            </ul>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3>7.8 é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶</h3>

                        <table>
                            <thead>
                                <tr>
                                    <th>é”™è¯¯ç±»å‹</th>
                                    <th>æ£€æµ‹æ–¹å¼</th>
                                    <th>å¤„ç†ç­–ç•¥</th>
                                    <th>å…œåº•æ–¹æ¡ˆ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>æ„å›¾è¯†åˆ«å¤±è´¥</td>
                                    <td>ç½®ä¿¡åº¦ < 0.5 æˆ– å¼‚å¸¸</td>
                                    <td>é™ä½é˜ˆå€¼é‡è¯•ä¸€æ¬¡</td>
                                    <td>è¿”å›unknownæ„å›¾å…œåº•å“åº”</td>
                                </tr>
                                <tr>
                                    <td>MCPå·¥å…·è¶…æ—¶</td>
                                    <td>asyncio.wait_forè¶…æ—¶</td>
                                    <td>3æ¬¡æŒ‡æ•°é€€é¿é‡è¯•</td>
                                    <td>ä½¿ç”¨æœ¬åœ°çŸ¥è¯†åº“æ•°æ®</td>
                                </tr>
                                <tr>
                                    <td>LLMæœåŠ¡å¼‚å¸¸</td>
                                    <td>HTTPé”™è¯¯/è¶…æ—¶</td>
                                    <td>æ•è·å¼‚å¸¸ï¼Œè®°å½•æ—¥å¿—</td>
                                    <td>ä½¿ç”¨é¢„å®šä¹‰æ¨¡æ¿å“åº”</td>
                                </tr>
                                <tr>
                                    <td>å‚æ•°ç¼ºå¤±</td>
                                    <td>å®ä½“æŠ½å–ä¸ºç©º</td>
                                    <td>è§¦å‘æ¾„æ¸…å¯¹è¯</td>
                                    <td>å¼•å¯¼ç”¨æˆ·è¾“å…¥ç¼ºå¤±ä¿¡æ¯</td>
                                </tr>
                                <tr>
                                    <td>æ•°æ®éªŒè¯å¤±è´¥</td>
                                    <td>æ‰‹æœºå·æ ¼å¼é”™è¯¯</td>
                                    <td>è¿”å›å…·ä½“é”™è¯¯æç¤º</td>
                                    <td>è¦æ±‚é‡æ–°è¾“å…¥</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="code-block" style="margin-top: 20px;">
<span style="color:#75715e"># é‡è¯•æœºåˆ¶ç¤ºä¾‹</span>
<span style="color:#66d9ef">async def</span> <span style="color:#a6e22e">call_tool_with_retry</span>(tool_name, params, max_retries=<span style="color:#ae81ff">3</span>):
    <span style="color:#66d9ef">for</span> attempt <span style="color:#66d9ef">in</span> range(max_retries):
        <span style="color:#66d9ef">try</span>:
            result = <span style="color:#66d9ef">await</span> mcp_client.call_tool(tool_name, params, timeout=<span style="color:#ae81ff">30</span>)
            <span style="color:#66d9ef">if</span> result.success:
                <span style="color:#66d9ef">return</span> result
        <span style="color:#66d9ef">except</span> asyncio.TimeoutError:
            <span style="color:#66d9ef">if</span> attempt == max_retries - <span style="color:#ae81ff">1</span>:
                <span style="color:#66d9ef">return</span> get_fallback_result(tool_name, params)
            <span style="color:#66d9ef">await</span> asyncio.sleep(<span style="color:#ae81ff">2</span> ** attempt)  <span style="color:#75715e"># æŒ‡æ•°é€€é¿</span>
                        </div>
                    </div>
                </div>

                <!-- ç‰ˆæœ¬ä¿¡æ¯ -->
                <div class="section">
                    <h2 class="section-title">
                        <span class="icon">ğŸ“Œ</span>
                        ç‰ˆæœ¬ä¿¡æ¯
                    </h2>

                    <table>
                        <thead>
                            <tr>
                                <th>é¡¹ç›®</th>
                                <th>ä¿¡æ¯</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>é¡¹ç›®åç§°</td>
                                <td>åŒ»ç–—æ™ºèƒ½åŠ©æ‰‹ (Medical AI Assistant)</td>
                            </tr>
                            <tr>
                                <td>ç‰ˆæœ¬å·</td>
                                <td>v2.0.0</td>
                            </tr>
                            <tr>
                                <td>æœ€åæ›´æ–°</td>
                                <td>2026-02-02</td>
                            </tr>
                            <tr>
                                <td>æŠ€æœ¯æ ˆ</td>
                                <td>Python 3.10+, FastAPI, MLP, Vue.js (æ¶æ„å‚è€ƒ)</td>
                            </tr>
                            <tr>
                                <td>ä»£ç ä»“åº“</td>
                                <td>https://github.com/aitachi/medical_agent</td>
                            </tr>
                            <tr>
                                <td>æ–‡æ¡£ç”Ÿæˆ</td>
                                <td>è‡ªåŠ¨ç”Ÿæˆäº 2026-02-02</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>Â© 2026 åŒ»ç–—æ™ºèƒ½åŠ©æ‰‹ - ç³»ç»Ÿæ¶æ„æ–‡æ¡£</p>
        <p style="margin-top: 10px; font-size: 0.9em; opacity: 0.7;">
            å…è´£å£°æ˜: æœ¬ç³»ç»Ÿä»…ä¸ºæŠ€æœ¯æ¼”ç¤ºï¼Œå®é™…åŒ»ç–—åº”ç”¨éœ€éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„å¹¶ç»ä¸“ä¸šè®¤è¯
        </p>
    </div>

    <script>
        function showTab(evt, tabName) {
            var i, tabcontent, tabs;

            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
                tabcontent[i].classList.remove("active");
            }

            tabs = document.getElementsByClassName("tab");
            for (i = 0; i < tabs.length; i++) {
                tabs[i].className = tabs[i].className.replace(" active", "");
            }

            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        // å¹³æ»‘æ»šåŠ¨
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>
</body>
</html>
